<script lang="ts">
  import { ndk } from '$lib/store/ndk.txt';
  import type { NDKEvent, NDKTag } from '@nostr-dev-kit/ndk';
  import { writable } from 'svelte/store';

  const eventsList = writable<NDKEvent[]>([]);
  const tagsList = writable<NDKTag[]>([]);

  const sub = $ndk.subscribe(
    {
      kinds: [0, 1]
      // authors: []
    },
    { closeOnEose: false }
  );

  sub.on('event', (event) => {
    const tagId = event.tagId();
    eventsList.update((u) => [...u, event]);
    tagsList.update((u) => [...u, tagId]);
  });
</script>

<h1>Welcome to Highlighter mobile</h1>
<div class="bg-lime-300">
  so <span class="rounded-xl bg-purple-200 text-white font-bold px-1">cool!</span>
</div>

{#if $eventsList.length > 0}
  {#each $eventsList as event}
    {#key event}
      <div class="flex flex-col w-full px-12 space-y-4 break-all">
        <div class="flex flex-row w-full justify-center items-center px-2">
          {`insert avatar here`}
        </div>
        <p class="font-sans font-medium text-base">
          {event.author.npub}
        </p>
        <p class="font-sans font-medium text-base">
          {event.content}
        </p>
      </div>
    {/key}
  {/each}
{/if}
